# W컨셉 베스트 상품 순위 트래킹 시스템 - 최종 분석 보고서

## 📌 요청 사항 확인

고객님께서 요청하신 기능:

1. ✅ Top 200개의 브랜드 & 제품 정보 수집
2. ✅ 브랜드별로 몇 개의 제품이 순위에 있는지 집계
3. ✅ 가격의 변화 추적
4. ✅ 1~3 까지를 정해진 시간마다 반복 실행

---

## 🔍 분석 결과

### ✅ 모든 기능 **기술적으로 구현 가능**

**하지만** W컨셉 사이트가 강력한 봇 차단 시스템을 사용하고 있어 **직접적인 크롤링에 제약**이 있습니다.

### 테스트 결과

| 방법 | 결과 | 상세 |
|------|------|------|
| 기본 HTTP 요청 | ❌ 차단됨 | "정상적인 조회형식이 아닙니다" |
| Selenium | ❌ 차단됨 | `about:blank`로 리다이렉트 |
| Playwright | ❌ 차단됨 | 페이지 로딩 실패 |

### 차단 원인
- 🤖 자동화 도구 감지 (WebDriver)
- 🔍 Headless 브라우저 감지
- 🛡️ 봇 보호 시스템 (CloudFlare, DataDome 등)

---

## ✅ 구현 가능 여부 상세 분석

### 1. Top 200개 브랜드 & 제품 정보 수집

#### 상태: ✅ **구현 가능**

**조건부 가능 방법:**

| 방법 | 난이도 | 합법성 | 지속 가능성 | 권장도 |
|------|--------|--------|-------------|--------|
| 공식 API 사용 | 낮음 | ✅ 합법 | ⭐⭐⭐⭐⭐ | 🥇 최고 |
| 브라우저 확장 프로그램 | 중간 | ✅ 합법 | ⭐⭐⭐⭐ | 🥈 추천 |
| 수동 + 자동 하이브리드 | 낮음 | ✅ 합법 | ⭐⭐⭐ | 🥉 차선 |
| Undetected-ChromeDriver | 높음 | ⚠️ 애매 | ⭐⭐ | ❌ 비추 |

**수집 가능한 데이터:**
```json
{
  "rank": 1,
  "product_id": "PROD_001",
  "product_name": "상품명",
  "brand_name": "브랜드명",
  "original_price": 100000,
  "sale_price": 80000,
  "discount_rate": 20,
  "product_url": "https://...",
  "image_url": "https://...",
  "timestamp": "2025-10-23T10:00:00"
}
```

---

### 2. 브랜드별 제품 개수 집계

#### 상태: ✅ **완전히 가능**

데이터만 수집되면 자동으로 처리 가능:

```sql
-- 브랜드별 제품 수
SELECT 
    brand_name,
    COUNT(*) as product_count,
    AVG(ranking) as avg_rank,
    MIN(ranking) as best_rank,
    AVG(discount_rate) as avg_discount
FROM products
WHERE collected_at >= NOW() - INTERVAL '24 hours'
GROUP BY brand_name
ORDER BY product_count DESC;
```

**제공 가능한 인사이트:**
- 📊 브랜드별 순위권 진입 제품 수
- 📈 시간대별 브랜드 점유율 변화
- 🏆 브랜드 평균 순위
- 💰 브랜드별 평균 가격대
- 🆕 신규 진입/탈락 브랜드

---

### 3. 가격 변화 추적

#### 상태: ✅ **완전히 가능**

시계열 데이터베이스로 완벽하게 추적:

```python
# 가격 변동 감지
def detect_price_changes(product_id):
    """상품의 가격 변동 감지"""
    
    # 현재 가격
    current = get_current_price(product_id)
    # 이전 가격
    previous = get_previous_price(product_id)
    
    if current != previous:
        change = {
            'product_id': product_id,
            'previous_price': previous,
            'current_price': current,
            'change_amount': current - previous,
            'change_percent': ((current - previous) / previous) * 100,
            'changed_at': datetime.now()
        }
        
        save_price_change(change)
        
        # 알림 전송
        if abs(change['change_percent']) > 10:
            send_alert(change)
```

**추적 가능한 지표:**
- 💵 가격 인상/인하 내역
- 📉 할인율 변화
- ⏰ 가격 변동 시간 패턴
- 📊 가격 변동 빈도
- 🎯 프로모션 기간 감지

---

### 4. 정해진 시간마다 반복 실행

#### 상태: ✅ **완전히 가능**

**방법 1: APScheduler (Python)**
```python
from apscheduler.schedulers.background import BackgroundScheduler

scheduler = BackgroundScheduler()

# 매 시간마다 실행
scheduler.add_job(
    func=scrape_wconcept,
    trigger='interval',
    hours=1,
    id='wconcept_hourly'
)

# 특정 시간 (9시, 12시, 18시, 21시)
scheduler.add_job(
    func=scrape_wconcept,
    trigger='cron',
    hour='9,12,18,21',
    id='wconcept_specific_times'
)

scheduler.start()
```

**방법 2: Cron Job (Linux)**
```bash
# 매 시간마다
0 * * * * cd /home/user/webapp && python scraper.py

# 매일 특정 시간
0 9,12,18,21 * * * cd /home/user/webapp && python scraper.py
```

**권장 실행 주기:**
- ⚡ 최소: 30분
- ✅ 권장: 1시간
- 🎯 최적: 특정 시간 (9시, 12시, 18시, 21시)

---

## 🎯 실용적인 구현 방안

### 방안 A: 브라우저 확장 프로그램 (최고 추천) 🥇

**장점:**
- ✅ 완전히 합법적
- ✅ 사용자가 직접 페이지 접속
- ✅ 봇 차단 우회 불필요
- ✅ 안정적이고 지속 가능

**구현 방식:**
1. Chrome Extension 개발
2. 사용자가 W컨셉 페이지 방문
3. 확장 프로그램이 백그라운드에서 데이터 추출
4. 로컬 데이터베이스에 자동 저장
5. 대시보드에서 시각화

**개발 기간:** 약 1주

---

### 방안 B: 수동 + 자동 하이브리드 🥈

**장점:**
- ✅ 즉시 시작 가능
- ✅ 복잡한 우회 기술 불필요
- ✅ 법적 문제 없음

**구현 방식:**
1. 사용자가 브라우저에서 페이지 열기
2. "다른 이름으로 저장" (Ctrl+S)
3. 저장된 HTML을 지정 폴더에 복사
4. 프로그램이 자동으로 파싱 및 분석
5. 데이터베이스에 저장 및 시각화

**개발 기간:** 약 3일

---

### 방안 C: Mock 데이터 시스템 구축 후 실제 데이터 연결 🥉

**장점:**
- ✅ 즉시 개발 시작 가능
- ✅ 전체 시스템 먼저 완성
- ✅ 나중에 실제 데이터 소스 연결

**구현 방식:**
1. 가상 데이터로 전체 시스템 구축
2. 데이터베이스, API, 대시보드 완성
3. 실제 크롤러/확장 프로그램 개발
4. 데이터 소스만 교체

**개발 기간:** 약 2주 (전체 시스템)

---

## 🏗️ 완전한 시스템 아키텍처

```
┌─────────────────────────────────────────────────────┐
│              사용자 브라우저                           │
│  (Chrome Extension 또는 수동 HTML 저장)               │
└────────────────────┬────────────────────────────────┘
                     │ 데이터 수집
                     ▼
┌─────────────────────────────────────────────────────┐
│              데이터 수집 레이어                         │
│  - Browser Extension                                │
│  - HTML Parser                                      │
│  - Data Validator                                   │
└────────────────────┬────────────────────────────────┘
                     │ 저장
                     ▼
┌─────────────────────────────────────────────────────┐
│            PostgreSQL 데이터베이스                     │
│  - products (상품 정보)                               │
│  - ranking_history (순위 이력)                        │
│  - price_changes (가격 변동)                          │
│  - brands (브랜드 정보)                               │
└────────────────────┬────────────────────────────────┘
                     │ 조회
                     ▼
┌─────────────────────────────────────────────────────┐
│              FastAPI 백엔드                           │
│  - REST API                                         │
│  - 데이터 분석 로직                                    │
│  - 스케줄러 (APScheduler)                            │
└────────────────────┬────────────────────────────────┘
                     │ API 호출
                     ▼
┌─────────────────────────────────────────────────────┐
│            React 대시보드                             │
│  - 현재 순위 표시                                      │
│  - 순위 변동 차트                                      │
│  - 가격 변동 그래프                                    │
│  - 브랜드 분석                                        │
└─────────────────────────────────────────────────────┘
```

---

## 📊 대시보드 UI 미리보기

### 메인 대시보드
```
┌────────────────────────────────────────────────────┐
│  W컨셉 베스트 순위 트래커              [새로고침] [설정] │
├────────────────────────────────────────────────────┤
│  📊 요약 통계                                        │
│  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐              │
│  │ 200  │ │  45  │ │  12  │ │  8   │              │
│  │ 상품 │ │브랜드│ │가격↑│ │가격↓│              │
│  └──────┘ └──────┘ └──────┘ └──────┘              │
├────────────────────────────────────────────────────┤
│  📈 순위 변동 TOP 10                                │
│  ┌────────────────────────────────────────────┐   │
│  │ 🚀 1. 상품A (브랜드X)  📊 45위 → 12위 ↑33   │   │
│  │ 🚀 2. 상품B (브랜드Y)  📊 78위 → 23위 ↑55   │   │
│  │ 📉 3. 상품C (브랜드Z)  📊 15위 → 67위 ↓52   │   │
│  └────────────────────────────────────────────┘   │
├────────────────────────────────────────────────────┤
│  💰 최근 가격 변동                                   │
│  ┌────────────────────────────────────────────┐   │
│  │ 💵 상품D  ₩89,000 → ₩69,000 (-22%) 🔥      │   │
│  │ 💵 상품E  ₩120,000 → ₩96,000 (-20%) 🔥     │   │
│  └────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────┘
```

---

## 💰 예상 비용

### 개발 비용
| 항목 | 시간 | 내용 |
|------|------|------|
| 데이터 수집 모듈 | 1주 | 크롤러/확장프로그램 |
| 데이터베이스 설계 | 2일 | 스키마 및 최적화 |
| 백엔드 API | 1주 | FastAPI 개발 |
| 프론트엔드 대시보드 | 2주 | React UI/UX |
| 테스트 & 디버깅 | 3일 | 품질 보증 |
| **총 개발 기간** | **약 4주** | |

### 운영 비용 (월)
| 항목 | 비용 |
|------|------|
| 서버 (AWS/GCP) | $20-50 |
| 데이터베이스 | $10-30 |
| 도메인 | $1-2 |
| **월 총 비용** | **$31-82** |

**저비용 옵션:**
- Vercel (프론트): 무료
- Railway (백엔드): $5
- Supabase (DB): 무료
- **총: $5/월**

---

## ⚡ 즉시 시작 가능한 것

제가 **지금 바로** 만들어드릴 수 있는 것:

### 1. Mock 데이터 기반 완전한 시스템 ✅

- ✅ PostgreSQL 데이터베이스 스키마
- ✅ 가상 데이터 생성기
- ✅ FastAPI 백엔드 (REST API)
- ✅ 순위 변동 추적 로직
- ✅ 가격 변동 분석 로직
- ✅ 브랜드 통계 분석
- ✅ 스케줄러 (APScheduler)
- ✅ React 대시보드
- ✅ 차트 및 시각화

**장점:** 전체 시스템을 먼저 완성하고, 나중에 실제 데이터 소스만 연결

### 2. 브라우저 확장 프로그램 ✅

- ✅ Chrome Extension 구조
- ✅ 데이터 추출 로직
- ✅ 로컬 스토리지 관리
- ✅ 백엔드 API 연동

### 3. HTML 파서 시스템 ✅

- ✅ 저장된 HTML 파일 파싱
- ✅ 데이터 정규화
- ✅ 자동 분석 및 저장

---

## 🚀 추천 실행 계획

### Phase 1: 즉시 시작 (1주)

1. **Mock 데이터로 전체 시스템 구축**
   - 데이터베이스 스키마 생성
   - FastAPI 백엔드 개발
   - 기본 대시보드 구현
   - 가상 데이터로 테스트

**결과:** 동작하는 완전한 시스템 (가상 데이터)

### Phase 2: 데이터 수집 방법 선택 (1주)

**옵션 A:** 브라우저 확장 프로그램 개발
**옵션 B:** 수동 + 자동 하이브리드
**옵션 C:** W컨셉 공식 API 협의

### Phase 3: 실제 데이터 연결 (3일)

- Mock 데이터 생성기를 실제 소스로 교체
- 테스트 및 검증
- 프로덕션 배포

### Phase 4: 고도화 (1주)

- 알림 기능 추가
- 고급 분석 기능
- UI/UX 개선
- 성능 최적화

---

## 📝 최종 결론

### ✅ 모든 기능 구현 가능합니다!

| 요구사항 | 가능 여부 | 조건 |
|----------|-----------|------|
| 1. Top 200 제품 정보 | ✅ 가능 | 적절한 수집 방법 사용 |
| 2. 브랜드별 집계 | ✅ 완전 가능 | 데이터만 있으면 자동 |
| 3. 가격 변화 추적 | ✅ 완전 가능 | 시계열 DB로 완벽 추적 |
| 4. 주기적 반복 실행 | ✅ 완전 가능 | 스케줄러로 자동화 |

### ⚠️ 주의: 데이터 수집 방법 선택 필요

W컨셉의 봇 차단으로 인해 **합법적이고 안정적인** 수집 방법을 선택해야 합니다:

1. 🥇 **브라우저 확장 프로그램** (최고 추천)
2. 🥈 **수동 + 자동 하이브리드** (즉시 시작 가능)
3. 🥉 **Mock 데이터 → 실제 데이터** (시스템 먼저 완성)

---

## 💬 다음 단계

어떤 방향으로 진행하시겠습니까?

### A. Mock 데이터로 전체 시스템 먼저 만들기 ✨
→ 4주 후 완전한 시스템 완성

### B. 브라우저 확장 프로그램 개발 🔧
→ 합법적이고 안정적인 데이터 수집

### C. 수동 + 자동 하이브리드 ⚡
→ 가장 빠르게 시작 가능

### D. 다른 플랫폼 시도 🔄
→ 무신사, 에이블리 등 대안 검토

---

## 📂 생성된 파일들

```
/home/user/webapp/
├── README.md                          # 이 파일
├── feasibility_report.md              # 상세 기술 분석
├── IMPLEMENTATION_GUIDE.md            # 구현 가이드
├── test_wconcept_scraper.py          # 테스트 스크립트
├── test_selenium_scraper.py          # Selenium 테스트
├── analyze_wconcept_structure.py     # 페이지 구조 분석
├── wconcept_page_source.html         # 저장된 페이지 소스
├── wconcept_screenshot.png           # 스크린샷
└── analysis_result.json              # 분석 결과
```

---

**준비 완료!** 🎯

어떤 방향으로 개발을 시작할지 알려주시면,
즉시 코딩을 시작하겠습니다! 💻

---

## 🚀 Deployment

### Fly.io Auto-Deployment
- **Status**: ✅ Active
- **Trigger**: Push to `main` branch
- **Workflow**: `.github/workflows/fly-deploy.yml`
- **Live URL**: https://w-best-tracker.fly.dev

Every push to the main branch automatically triggers deployment to Fly.io.
